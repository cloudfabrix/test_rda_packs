rule_id,action,alarm_class,rule,severity,state,raise_code,grok,key_eval
A100,KEEP,Interface,"syslog_code = ""L2-BM-5-MBR_BFD_NOT_RUNNING""",CRITICAL,Open,,BFD session on link %{DATA:interface_name} in ,f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
A101,KEEP,Interface,"syslog_code = ""ROUTING-MPLS_TE-4-WARN""",CRITICAL,Open,,"TE-BFD not configured on intf\s*%{DATA:interface_name},",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
A102,KEEP,Interface,"syslog_code = ""PLATFORM-DPA-2-RX_FAULT""",MAJOR,Open,,"Interface\s*%{DATA:interface_name},",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
A103,KEEP,Interface,"syslog_code = ""PKT_INFRA-LINK-3-UPDOWN"" and message contains ""changed state to Down""",MAJOR,Open,,"Interface\s*%{DATA:interface_name},",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
A104,KEEP,Interface,"syslog_code = ""PKT_INFRA-LINK-3-UPDOWN"" and message contains ""changed state to Up""",MINOR,Clear,,"Interface\s*%{DATA:interface_name},",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
A105,KEEP,Interface,"syslog_code = ""PKT_INFRA-LINEPROTO-5-UPDOWN""  and message contains ""changed state to Down""",CRITICAL,Open,,"Line protocol on Interface\s*%{DATA:interface_name},",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
A106,KEEP,Interface,"syslog_code = ""PKT_INFRA-LINEPROTO-5-UPDOWN""  and message contains ""changed state to Up""",MINOR,Clear,,"Line protocol on Interface\s*%{DATA:interface_name},",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
A107,KEEP,Interface,"syslog_code = ""PKT_INFRA-LINK-5-CHANGED""",MAJOR,Open,,"Interface\s*%{DATA:interface_name},",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
A108,KEEP,Interface,"syslog_code = ""ROUTING-OSPF-5-ADJCHG"" and message contains ""to EXCHANGE""",MINOR,Clear,,.*Nbr\s%{IPV4:peer_ip}\son\s%{DATA:interface_name}\s.*,f'{rda_gw_client_ip}_{peer_ip}_{interface_name}_{syslog_code}'
A109,KEEP,Interface,"syslog_code = ""ROUTING-OSPF-5-ADJCHG""",CRITICAL,Open,,.*Nbr\s%{IPV4:peer_ip}\son\s%{DATA:interface_name}\s.*,f'{rda_gw_client_ip}_{peer_ip}_{interface_name}_{syslog_code}'
A110,DROP,Interface,"syslog_code = ""PKT_INFRA-FM-3-FAULT_MAJOR"" and message contains ""DECLARE""",CRITICAL,Open,,.*%%{DATA:syslog_code}\s:\s%{DATA:alarm_severity}\s:%{DATA:component_name}\s:%{DATA:state}\s:%{DATA}:\s\s%{GREEDYDATA:interface_name}\s\s,f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
A111,DROP,Interface,"syslog_code = ""PKT_INFRA-FM-3-FAULT_MAJOR"" and message contains ""CLEAR""",MINOR,Clear,,.*%%{DATA:syslog_code}\s:\s%{DATA:alarm_severity}\s:%{DATA:component_name}\s:%{DATA:state}\s:%{DATA}:\s\s%{GREEDYDATA:interface_name}\s\s,f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
A112,KEEP,License,"syslog_code = ""LICENSE-SMART_LIC-3-COMM_FAILED""",MINOR,Open,,,f'{rda_gw_client_ip}_{syslog_code}'
A113,KEEP,License,"syslog_code = ""LICENSE-SMART_LIC-3-AUTH_RENEW_FAILED""",MINOR,Open,LICENSE-SMART_LIC-3-COMM_FAILED,,f'{rda_gw_client_ip}_{raise_code}'
A114,KEEP,License,"syslog_code = ""LICENSE-SMART_LIC-5-COMM_RESTORED""",MINOR,Open,LICENSE-SMART_LIC-3-COMM_FAILED,.*is above %{NUMBER:disk_threshold}\%.*%{NUMBER:disk_current_usage}\..*,f'{rda_gw_client_ip}_{raise_code}'
A115,KEEP,Disk,"syslog_code = ""HA-HA_WD-3-DISK_ALARM_ALERT""",MINOR,Open,,,f'{rda_gw_client_ip}_{syslog_code}'
A116,KEEP,Interface,"syslog_code = ""OSPF-5-ADJCHG"" and message contains ""from FULL""",MAJOR,Open,,".*Process %{NUMBER:process}, Nbr %{DATA:neighbor} on %{DATA:interface_name} from %{DATA:from_state} to %{DATA:to_state},.*",f'{rda_gw_client_ip}_{neighbor}_{syslog_code}'
A116,KEEP,Interface,"syslog_code = ""OSPF-5-ADJCHG"" and message not contains ""from FULL""",MAJOR,Clear,,".*Process %{NUMBER:process}, Nbr %{DATA:neighbor} on %{DATA:interface_name} from %{DATA:from_state} to %{DATA:to_state},.*",f'{rda_gw_client_ip}_{neighbor}_{syslog_code}'
A117,KEEP,Interface,"syslog_code = ""LINEPROTO-5-UPDOWN"" and message contains ""state to down""",MAJOR,Open,,"Interface\s*%{DATA:interface_name},",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
A118,KEEP,Interface,"syslog_code = ""LINEPROTO-5-UPDOWN"" and message not contains ""state to down""",MAJOR,Clear,,"Interface\s*%{DATA:interface_name},",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
A119,KEEP,Interface,"syslog_code = ""LINK-3-UPDOWN"" and message not contains ""to up""",MAJOR,Open,,"Interface\s*%{DATA:interface_name},",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
A120,KEEP,Interface,"syslog_code = ""LINK-3-UPDOWN"" and message contains ""to up""",MAJOR,Clear,,"Interface\s*%{DATA:interface_name},",f'{rda_gw_client_ip}_{interface_name}_{syslog_code}'
Z999,DROP,,*,,,,,
