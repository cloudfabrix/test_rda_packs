{
  "description": "SNMP_Traps",
  "sourcename": "SNMP_Traps",
  "targetname": "OIA Alert",
  "sourceendpointtype": "webhook-basic",
  "sourcecategory": "alerts",
  "sourcetypeid": "OIA Alert",
  "targetendpointtype": "kafka-notification",
  "targetcategory": "alerts",
  "targettypeid": "OIA Alert",
  "sourcebundle": "default",
  "targetbundle": "default",
  "sourcemapper": "default.mapper-default-events-inbound-json",
  "sourceartifact": "events-inbound-default.json",
  "targetmapper": null,
  "sourcepipeline": "default.pipeline-inbound",
  "targetpipeline": null,
  "enabled": "Yes",
  "filters": null,
  "enrichment": null,
  "scriptinput": null,
  "mappingtype": "json",
  "mappingscript": "{\n    \"mappings\": [\n      {\n        \"from\": \"rda_gw_ep_type\",\n        \"to\": \"alert_issue_type\"\n      },\n      {\n        \"from\": \"message\",\n        \"to\": \"message\"\n      },\n      {\n        \"from\": \"customer_tag\",\n        \"to\": \"customer_tag\"\n      },\n      {\n        \"from\": \"ifIndex\",\n        \"to\": \"ifIndex\",\n        \"func\": [\n          {\n            \"evaluate\": {\n              \"expr\": \"str(ifIndex).split('.')[0]\"\n            }\n          }\n        ]\n      },\n      {\n        \"from\": \"snmp_trap_name\",\n        \"to\": \"snmp_trap_name\"\n      },\n      {\n        \"to\": \"snmp_trap_type\",\n        \"func\": [\n          {\n            \"evaluate\": {\n              \"expr\": \"'linkStatus' if snmp_trap_name == 'linkUp' or snmp_trap_name == 'linkDown' else snmp_trap_name\"\n            }\n          }\n        ]\n      },\n      {\n        \"from\": \"snmp_trap_type\",\n        \"to\": \"alertType\"\n      },\n      {\n        \"from\": \"port_channel_name\",\n        \"to\": \"port_channel_name\",\n        \"func\": {\n          \"when_null\": {\n            \"value\": \"\"\n          }\n        }\n      },\n      {\n        \"from\": \"device_int_shortname\",\n        \"to\": \"device_int_shortname\",\n        \"func\": {\n          \"when_null\": {\n            \"value\": \"\"\n          }\n        }\n      },\n      {\n        \"to\": \"port_channel_name\",\n        \"func\": [\n          {\n            \"evaluate\": {\n              \"expr\": \"device_int_shortname if 'Po' in device_int_shortname else port_channel_name\"\n            }\n          }\n        ]\n      },\n      {\n        \"from\": \"cdp_device_order\",\n        \"to\": \"cdp_device_order\"\n      },\n      {\n        \"to\": \"cdp_device_order\",\n        \"func\": [\n          {\n            \"evaluate\": {\n              \"expr\": \"'9.3.140.19:9.3.140.20' if port_channel_name and 'Po' in port_channel_name else cdp_device_order if cdp_device_order and cdp_device_order != '' else ''\"\n            }\n          }\n        ]\n      },\n      {\n        \"from\": \"snmp_trap_oid\",\n        \"to\": \"snmp_trap_oid\"\n      },\n      {\n        \"from\": \"rda_gw_client_ip\",\n        \"to\": \"assetIpAddress\"\n      },\n      {\n        \"from\": \"device_int_name\",\n        \"to\": \"interface_name\"\n      },\n      {\n        \"from\": \"device_ip\",\n        \"to\": \"device_ip\",\n        \"func\": {\n          \"when_null\": {\n            \"value\": \"\"\n          }\n        }\n      },\n      {\n        \"from\": \"device_hostname_short\",\n        \"to\": \"assetName\"\n      },\n      {\n        \"to\": \"state\",\n        \"func\": {\n          \"evaluate\": {\n            \"expr\": \"'Open'\"\n          }\n        }\n      },\n      {\n        \"from\": \"timestamp\",\n        \"to\": \"_tmp_triggered_time\",\n        \"func\": {\n          \"datetime\": {}\n        }\n      },\n      {\n        \"to\": \"raisedAt\",\n        \"func\": [\n          {\n            \"evaluate\": {\n              \"expr\": \"_tmp_triggered_time if state == 'Open' else 0\"\n            }\n          }\n        ]\n      },\n      {\n        \"to\": \"clearedAt\",\n        \"func\": [\n          {\n            \"evaluate\": {\n              \"expr\": \"_tmp_triggered_time if state == 'Clear' else 0\"\n            }\n          }\n        ]\n      },\n      {\n        \"from\": \"severity\",\n        \"to\": \"severity\",\n        \"func\": {\n          \"map_values\": {\n            \"Warning\": \"WARNING\",\n            \"Major\": \"MAJOR\",\n            \"Critical\": \"CRITICAL\",\n            \"*\": \"WARNING\"\n          }\n        }\n      },\n      {\n        \"func\": [\n          {\n            \"stream_enrich\": {\n              \"name\": \"network_devices_cdp\",\n              \"condition\": \"device_ip is '$assetIpAddress' and device_int_name is '$interface_name'\",\n              \"enriched_columns\": \"interface_connectivity_key\"\n            }\n          }\n        ]\n      },\n      {\n        \"func\": {\n          \"stream_enrich\": {\n            \"name\": \"cfx-rdaf-topology-nodes\",\n            \"condition\": \"node_id is '$assetIpAddress'\",\n            \"enriched_columns\": \"\"\n          }\n        }\n      },\n      {\n        \"from\": \"snmp_trap_name\",\n        \"to\": \"alarm_class\",\n        \"func\": {\n          \"map_values\": {\n            \"linkDown\": \"Interface\",\n            \"linkUp\": \"Interface\",\n            \"warmStart\": \"Device\",\n            \"coldStart\": \"Device\"\n          }\n        }\n      },\n      {\n        \"from\": \"snmp_trap_name\",\n        \"to\": \"alarm_description\",\n        \"func\": {\n          \"map_values\": {\n            \"linkDown\": \"Interface down\",\n            \"linkUp\": \"Interface down (CLEARED)\",\n            \"warmStart\": \"Device down\",\n            \"coldStart\": \"Device down\"\n          }\n        }\n      },\n      {\n      \"to\": \"stack_name\",\n      \"func\": {\n        \"evaluate\":{\n            \"expr\":\"'cfx_rdaf_topology'\"\n        }\n      }\n    },\n      {\n        \"to\": \"key\",\n        \"func\": [\n          {\n            \"evaluate\": {\n              \"expr\": \"device_ip+''+snmp_trap_type+''+ifIndex if ifIndex else device_ip+''+snmp_trap_type\"\n            }\n          }\n        ]\n      }\n    ],\n    \"keepUnmapped\": true\n  }\n  ",
  "attributes": null,
  "created": null,
  "updated": null,
  "creator": null,
  "updator": null
}